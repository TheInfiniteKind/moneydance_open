/*
 * Author: Stuart Beesley - February 2026
 * usage.gradle: gradle buildfile that simply displays usage information for this build set
 * This should not be run standalone
*/
final Project p = project

if (!p.ext.has("executingMainBuild")) { throw new GradleException("usage.gradle must be applied from build.gradle, not executed standalone!") }

ext.printUsage = {
  logger.lifecycle("")
  logger.lifecycle("-------------------------------------------------------------------------------------------------------------------------")
  logger.lifecycle("Moneydance Gradle build - usage")
  logger.lifecycle("")
  logger.lifecycle("./gradlew verifyConfig         -> configuration + path checks (default)")
  logger.lifecycle("./gradlew <extensionname>      -> build & sign one extension - e.g. ")
  logger.lifecycle("./gradlew allJavaKotlin        -> build all Java/Kotlin extensions")
  logger.lifecycle("./gradlew allPython            -> build all Python extensions")
  logger.lifecycle("./gradlew all                  -> build everything")
  logger.lifecycle("./gradlew clean                -> removes the dist folder, and all build/compiled files")
  logger.lifecycle("./gradlew cleanextensionname   -> cleanup a single extension's build files")
  logger.lifecycle("./gradlew ensureDist           -> ensure the dist folder is present (otherwise does nothing)")
  logger.lifecycle("./gradlew ensureUserConfig     -> ensure the userconfig folder is present (otherwise does nothing)")
  logger.lifecycle("./gradlew ensureUserProperties -> creates user.gradle.properties file/template if missing (otherwise does nothing)")
  logger.lifecycle("./gradlew migrateAntUserConfig -> performs a one-time migration of ant properties/key file(s) to gradle (prompts to overwrite)")
  logger.lifecycle("")
  logger.lifecycle("Configuration files (in order of precedence):")
  logger.lifecycle("  userconfig/user.gradle.properties   (user overrides - not committed to git)")
  logger.lifecycle("  gradle/gradle.properties            (base set of properties - committed to git")
  logger.lifecycle("")
  logger.lifecycle("Signing setup:")
  logger.lifecycle("  Set keypass=<your passphrase> in user.gradle.properties")
  logger.lifecycle("  Then run: ./gradlew genkeys")
  logger.lifecycle("")
  logger.lifecycle("Optional flags (user.gradle.properties):")
  logger.lifecycle("  debug=true                   -> enable additional debug messages")
  logger.lifecycle("  mdbuildlibs=<folder>         -> specify folder containing a 'master set' of Moneydance jars (overriding lib folder jars)")
  logger.lifecycle("")
  logger.lifecycle("-------------------------------------------------------------------------------------------------------------------------")
  logger.lifecycle("")
}